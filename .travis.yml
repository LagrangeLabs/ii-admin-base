language: node_js
node_js:
  - stable
cache:
  directories:
    - node_modules

# 设置环境变量
env:
  matrix:
    - CI=true

script:
  # 默认运行编译脚本
  - npm run build-storybook

deploy:
  # 发布到 gh-pages 上
  - provider: script
    # Do not delete the build assets
    skip_cleanup: true
    script: bash scripts/deploy.sh
    on:
      # 当 master 有 push 的时候，触发 deploy 操作
      branch: master
  # 发布到 npm 上
  - provider: npm
    email: '$NPM_EMAIL'
    api_key: 'NPM_API_TOKEN'
    skip_cleanup: true
    on:
      branch: master
